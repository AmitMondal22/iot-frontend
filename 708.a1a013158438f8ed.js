"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[708],{708:(Z,D,r)=>{r.d(D,{d:()=>h});var o=r(9862),u=r(5219),n=r(6814),t=r(4769),v=r(3859),C=r(5905),m=r(95),b=r(981),M=r(8814),O=r(9252),f=r(7327),P=r(6804);const c=function(){return{standalone:!0}};let h=(()=>{var a;class l{constructor(i,e,g,s,_,p,T,y,U){this.datePipe=i,this.layoutService=e,this.authservice=g,this.fb=s,this.http=_,this.productService=p,this.messageService=T,this.confirmationService=y,this.api=U,this.filteredCountries=[],this.filteredDealer=[],this.countries=[],this.selectedState=null,this.data1=[],this.cities=[],this.liveData=[],this.flowData=[],this.flowDate=[],this.rpmData=[],this.rpmDate=[],this.user_type="",this.lastUpdateTime="",this.DeviceUrl="",this.deviceStatus=!1,this.subscription=this.layoutService.configUpdate$.subscribe(E=>{this.initCharts()})}convertToISTDateTime(i){const e=new Date(i);return this.datePipe.transform(e,"dd-MM-yyyy HH:mm:ss","+0530")||""}ngOnInit(){this.user_type=localStorage.getItem("u_type"),this.DeviceUrl="0"==this.user_type?"/":"/origination/",this.initCharts(),this.getDevice(),setInterval(()=>{this.currTm=" | "+(new Date).toString().substring(16,24)+" ",this.currDt=(new Date).toString().substring(0,15)}),setInterval(()=>{this.selectedDealer?.device_name?this.getDeviceLiveData(this.selectedDealer?.device_name):console.log("hii"),this.getDevice()},2e4)}getDevice(){const i=this.api.baseUrl,e=localStorage.getItem("token"),g=(new o.WM).set("Authorization",`Bearer ${e}`);this.http.get(i+this.DeviceUrl+"device/list",{headers:g}).subscribe(s=>{console.log(s),this.data1=s,this.cities=this.data1.data},s=>{401==s.status&&this.authservice.logout(),console.error(s)})}dateConvt(i){const e=new Date(i),_=`${String(e.getMonth()+1).padStart(2,"0")}/${String(e.getDate()).padStart(2,"0")}`;return console.log(_),_}getDeviceLiveData(i){if(i){const e=localStorage.getItem("token"),g=(new o.WM).set("Authorization",`Bearer ${e}`);this.liveData=[],this.liveData2=null;const s={device_id:i};this.deviceStatus=!1,this.http.post(this.api.baseUrl+this.DeviceUrl+"device-data/last",s,{headers:g}).subscribe(_=>{console.log(_),this.data1=_,this.data1=this.data1.data,this.deviceStatus="Online"==this.data1.device_status,this.data1&&(this.flowDate=[],this.flowData=[],this.rpmDate=[],this.rpmData=[],this.liveData=this.data1.chart_data_list,this.liveData2=this.data1.device_data_list,this.liveData.forEach(p=>{this.flowDate.push(this.dateConvt(p.created_at)),this.flowData.push(p.flow),this.rpmDate.push(this.dateConvt(p.created_at)),this.rpmData.push(p.rpm.toString()),console.log(this.flowDate),console.log(this.flowData),console.log(this.rpmDate),console.log(this.rpmData)}),this.flowDate&&this.flowData&&this.rpmDate&&this.rpmData&&(this.lastUpdateTime="",this.lastUpdateTime=this.convertToISTDateTime(this.liveData2.created_at),console.log(this.lastUpdateTime),this.initCharts()))},_=>{console.error(_)})}}dateChange(i){const p=new Date(this.liveData2.created_at).toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1,timeZone:"Asia/Kolkata"});return console.log(p),p}setDevice(){console.log(this.selectedDealer),this.getDeviceLiveData(this.selectedDealer.device_name)}filterDealer(i){const e=[],g=i.query;for(let s=0;s<this.cities.length;s++){const _=this.cities[s];0==_.device_name.toLowerCase().indexOf(g.toLowerCase())&&e.push(_)}this.filteredDealer=e}initCharts(){const i=getComputedStyle(document.documentElement),e=i.getPropertyValue("--text-color"),g=i.getPropertyValue("--text-color-secondary"),s=i.getPropertyValue("--surface-border");this.flow={labels:this.flowDate,datasets:[{label:"flow",data:this.flowData,fill:!1,backgroundColor:"green",borderColor:"green",tension:.4}]},this.rpm={labels:this.rpmDate,datasets:[{label:"RPM",data:this.rpmData,fill:!1,backgroundColor:"red",borderColor:"red",tension:.4}]},this.lineOptions={plugins:{legend:{labels:{fontColor:e}}},scales:{x:{ticks:{color:g},grid:{color:s,drawBorder:!1}},y:{ticks:{color:g},grid:{color:s,drawBorder:!1}}}}}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return(a=l).\u0275fac=function(i){return new(i||a)(t.Y36(n.uU),t.Y36(v.P),t.Y36(C.$),t.Y36(m.qu),t.Y36(o.eN),t.Y36(b.M),t.Y36(u.ez),t.Y36(u.YP),t.Y36(M.s))},a.\u0275cmp=t.Xpm({type:a,selectors:[["ng-component"]],features:[t._Bn([u.ez,u.YP,n.uU])],decls:92,vars:19,consts:[[1,"grid","p-fluid"],[1,"col-12","lg:col-12"],[1,"card",2,"padding","0!important"],[1,"grid",2,"margin-left","0rem!important"],[1,"col-12","lg:col-2","xl:col-1"],[1,"livenow"],[1,"col-12","lg:col-2","xl:col-1",2,"margin-top","28px","width","10%"],["onLabel","Online","offLabel","Offline",3,"styleClass","ngModel","ngModelChange"],[1,"col-12","lg:col-2","xl:col-5"],[2,"margin-top","32px"],[1,"field","col-12","md:col-3",2,"margin-left","54px"],["placeholder","Device Id","field","device_name",3,"ngModel","ngModelOptions","suggestions","dropdown","ngModelChange","onSelect","completeMethod"],[1,"col-12","lg:col-6","xl:col-4"],[1,"card","mb-0","xcard"],[1,"flex","justify-content-between","mb-3"],[1,"block","text-500","font-medium","mb-3"],[1,"text-900","font-medium","text-xl"],["src","assets/demo/images/access/current2.png","alt","logo",1,"xxx"],["src","assets/demo/images/access/rpm.png","alt","logo",2,"height","65px"],[1,"col-12","lg:col-6","xl:col-3"],["src","assets/demo/images/access/freq_setting2.png","alt","logo",1,"xxx"],["src","assets/demo/images/access/freq_run2.png","alt","logo",1,"xxx"],["src","assets/demo/images/access/spfull1.png","alt","logo",1,"xxx"],["src","assets/demo/images/access/time-icon2.png","alt","logo",1,"xxx"],[1,"col-12","lg:col-6"],[1,"card"],["type","line",3,"data","options"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t._UZ(6,"div"),t.TgZ(7,"h5"),t._uU(8,"Live"),t.qZA()()(),t.TgZ(9,"div",6)(10,"p-toggleButton",7),t.NdJ("ngModelChange",function(s){return e.deviceStatus=s}),t.qZA()(),t.TgZ(11,"div",8)(12,"h4",9),t._uU(13),t.qZA()(),t.TgZ(14,"div",10)(15,"label"),t._uU(16,"\xa0"),t.qZA(),t.TgZ(17,"p-autoComplete",11),t.NdJ("ngModelChange",function(s){return e.selectedDealer=s})("onSelect",function(){return e.setDevice()})("completeMethod",function(s){return e.filterDealer(s)}),t.qZA()()()(),t.TgZ(18,"div",3)(19,"div",12)(20,"div",13)(21,"div",14)(22,"div")(23,"span",15),t._uU(24,"DC Bus Voltage"),t.qZA(),t.TgZ(25,"div",16),t._uU(26),t.qZA()(),t._UZ(27,"img",17),t.qZA()()(),t.TgZ(28,"div",12)(29,"div",13)(30,"div",14)(31,"div")(32,"span",15),t._uU(33,"Output Current"),t.qZA(),t.TgZ(34,"div",16),t._uU(35),t.qZA()(),t._UZ(36,"img",17),t.qZA()()(),t.TgZ(37,"div",12)(38,"div",13)(39,"div",14)(40,"div")(41,"span",15),t._uU(42,"Output RPM"),t.qZA(),t.TgZ(43,"div",16),t._uU(44),t.qZA()(),t._UZ(45,"img",18),t.qZA()()(),t.TgZ(46,"div",19)(47,"div",13)(48,"div",14)(49,"div")(50,"span",15),t._uU(51,"Settings Frequency"),t.qZA(),t.TgZ(52,"div",16),t._uU(53),t.qZA()(),t._UZ(54,"img",20),t.qZA()()(),t.TgZ(55,"div",19)(56,"div",13)(57,"div",14)(58,"div")(59,"span",15),t._uU(60,"Running Frequency"),t.qZA(),t.TgZ(61,"div",16),t._uU(62),t.qZA()(),t._UZ(63,"img",21),t.qZA()()(),t.TgZ(64,"div",19)(65,"div",13)(66,"div",14)(67,"div")(68,"span",15),t._uU(69,"Flow"),t.qZA(),t.TgZ(70,"div",16),t._uU(71),t.qZA()(),t._UZ(72,"img",22),t.qZA()()(),t.TgZ(73,"div",19)(74,"div",13)(75,"div",14)(76,"div")(77,"span",15),t._uU(78,"Run Hrs"),t.qZA(),t.TgZ(79,"div",16),t._uU(80),t.qZA()(),t._UZ(81,"img",23),t.qZA()()()()(),t.TgZ(82,"div",24)(83,"div",25)(84,"h5"),t._uU(85,"Flow Graph"),t.qZA(),t._UZ(86,"p-chart",26),t.qZA()(),t.TgZ(87,"div",24)(88,"div",25)(89,"h5"),t._uU(90,"RPM Graph"),t.qZA(),t._UZ(91,"p-chart",26),t.qZA()()()),2&i&&(t.xp6(10),t.Q6J("styleClass","test")("ngModel",e.deviceStatus),t.xp6(3),t.hij("Last Updated: ",e.lastUpdateTime,""),t.xp6(4),t.Q6J("ngModel",e.selectedDealer)("ngModelOptions",t.DdM(18,c))("suggestions",e.filteredDealer)("dropdown",!0),t.xp6(9),t.hij("",e.liveData2?e.liveData2.dc_bus_voltage:0," V"),t.xp6(9),t.hij(" ",e.liveData2?e.liveData2.output_current:0," A"),t.xp6(9),t.hij("",e.liveData2?e.liveData2.rpm:0," "),t.xp6(9),t.hij("",e.liveData2?e.liveData2.settings_freq/100:0," Hz"),t.xp6(9),t.hij("",e.liveData2?e.liveData2.running_freq/100:0," Hz"),t.xp6(9),t.hij("",e.liveData2?e.liveData2.flow:0," % "),t.xp6(9),t.Oqu(e.liveData2?e.liveData2.time:0),t.xp6(6),t.Q6J("data",e.flow)("options",e.lineOptions),t.xp6(5),t.Q6J("data",e.rpm)("options",e.lineOptions))},dependencies:[O.C,f.Qc,m.JJ,m.On,P.CO],styles:["body[_ngcontent-%COMP%]{background-color:#333;h5 {font-family: sans-serif; color: #666; text-transform: uppercase; text-align: center; display: block; padding-top: 20px;}}.holder[_ngcontent-%COMP%]{max-width:455px;margin:0 auto}.holder[_ngcontent-%COMP%]   .follow[_ngcontent-%COMP%]{display:block;text-decoration:none;font-family:sans-serif;font-size:12px;color:#666;text-align:center}.livenow[_ngcontent-%COMP%]{margin-top:23px;width:30px;margin-left:15px;display:inline-block}.livenow[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{vertical-align:middle;width:22px;height:22px;border-radius:100%;position:absolute;margin:0 auto;border:3px solid rgb(255,0,0);animation:_ngcontent-%COMP%_live 1.4s infinite ease-in-out;animation-fill-mode:both}.livenow[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){background-color:#ffffff4d;background-color:#f81010;animation-delay:-.1s}.livenow[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){animation-delay:.16s}.livenow[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){animation-delay:.42s;border:3px solid rgba(255,255,255,.5)}.livenow[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){border:3px solid rgba(255,255,255,1);animation-delay:-.42s}@keyframes _ngcontent-%COMP%_live{0%,80%,to{transform:scale(.6);-webkit-transform:scale(.6)}40%{transform:scale(1);-webkit-transform:scale(1)}}.xcard[_ngcontent-%COMP%]{height:100%!important}.xxx[_ngcontent-%COMP%]{height:60px}  .test{background:red;color:#ff0}"]}),l})()},6804:(Z,D,r)=>{r.d(D,{CO:()=>f,KZ:()=>P});var o=r(1180),u=r(6814),n=r(4769),t=r(95),v=r(4480);const C=function(c,h){return{"p-button-icon":!0,"p-button-icon-left":c,"p-button-icon-right":h}};function m(c,h){if(1&c&&n._UZ(0,"span",3),2&c){const a=n.oxw();n.Tol(a.checked?a.onIcon:a.offIcon),n.Q6J("ngClass",n.WLB(3,C,"left"===a.iconPos,"right"===a.iconPos))}}function b(c,h){if(1&c&&(n.TgZ(0,"span",4),n._uU(1),n.qZA()),2&c){const a=n.oxw();n.xp6(1),n.Oqu(a.checked?a.hasOnLabel?a.onLabel:"":a.hasOffLabel?a.offLabel:"")}}const M=function(c,h,a){return{"p-button p-togglebutton p-component":!0,"p-button-icon-only":c,"p-highlight":h,"p-disabled":a}},O={provide:t.JU,useExisting:(0,n.Gpc)(()=>f),multi:!0};let f=(()=>{var c;class h{constructor(l){(0,o.Z)(this,"cd",void 0),(0,o.Z)(this,"onLabel",void 0),(0,o.Z)(this,"offLabel",void 0),(0,o.Z)(this,"onIcon",void 0),(0,o.Z)(this,"offIcon",void 0),(0,o.Z)(this,"ariaLabelledBy",void 0),(0,o.Z)(this,"disabled",void 0),(0,o.Z)(this,"style",void 0),(0,o.Z)(this,"styleClass",void 0),(0,o.Z)(this,"inputId",void 0),(0,o.Z)(this,"tabindex",void 0),(0,o.Z)(this,"iconPos","left"),(0,o.Z)(this,"onChange",new n.vpe),(0,o.Z)(this,"checked",!1),(0,o.Z)(this,"onModelChange",()=>{}),(0,o.Z)(this,"onModelTouched",()=>{}),this.cd=l}toggle(l){this.disabled||(this.checked=!this.checked,this.onModelChange(this.checked),this.onModelTouched(),this.onChange.emit({originalEvent:l,checked:this.checked}),this.cd.markForCheck())}onBlur(){this.onModelTouched()}writeValue(l){this.checked=l,this.cd.markForCheck()}registerOnChange(l){this.onModelChange=l}registerOnTouched(l){this.onModelTouched=l}setDisabledState(l){this.disabled=l,this.cd.markForCheck()}get hasOnLabel(){return this.onLabel&&this.onLabel.length>0}get hasOffLabel(){return this.onLabel&&this.onLabel.length>0}}return c=h,(0,o.Z)(h,"\u0275fac",function(l){return new(l||c)(n.Y36(n.sBO))}),(0,o.Z)(h,"\u0275cmp",n.Xpm({type:c,selectors:[["p-toggleButton"]],hostAttrs:[1,"p-element"],inputs:{onLabel:"onLabel",offLabel:"offLabel",onIcon:"onIcon",offIcon:"offIcon",ariaLabelledBy:"ariaLabelledBy",disabled:"disabled",style:"style",styleClass:"styleClass",inputId:"inputId",tabindex:"tabindex",iconPos:"iconPos"},outputs:{onChange:"onChange"},features:[n._Bn([O])],decls:3,vars:12,consts:[["role","checkbox","pRipple","",3,"ngClass","ngStyle","click","keydown.enter"],[3,"class","ngClass",4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass"],[1,"p-button-label"]],template:function(l,d){1&l&&(n.TgZ(0,"div",0),n.NdJ("click",function(e){return d.toggle(e)})("keydown.enter",function(e){return d.toggle(e)}),n.YNc(1,m,1,6,"span",1),n.YNc(2,b,2,1,"span",2),n.qZA()),2&l&&(n.Tol(d.styleClass),n.Q6J("ngClass",n.kEZ(8,M,d.onIcon&&d.offIcon&&!d.hasOnLabel&&!d.hasOffLabel,d.checked,d.disabled))("ngStyle",d.style),n.uIk("tabindex",d.disabled?null:"0")("aria-checked",d.checked),n.xp6(1),n.Q6J("ngIf",d.onIcon||d.offIcon),n.xp6(1),n.Q6J("ngIf",d.onLabel||d.offLabel))},dependencies:[u.mk,u.O5,u.PC,v.H],styles:['.p-button[_ngcontent-%COMP%]{margin:0;display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;align-items:center;vertical-align:bottom;text-align:center;overflow:hidden;position:relative}.p-button-label[_ngcontent-%COMP%]{flex:1 1 auto}.p-button-icon-right[_ngcontent-%COMP%]{order:1}.p-button[_ngcontent-%COMP%]:disabled{cursor:default;pointer-events:none}.p-button-icon-only[_ngcontent-%COMP%]{justify-content:center}.p-button-icon-only[_ngcontent-%COMP%]:after{content:"p";visibility:hidden;clip:rect(0 0 0 0);width:0}.p-button-vertical[_ngcontent-%COMP%]{flex-direction:column}.p-button-icon-bottom[_ngcontent-%COMP%]{order:2}.p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]{margin:0}.p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:last-child){border-right:0 none}.p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:first-of-type):not(:last-of-type){border-radius:0}.p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:first-of-type{border-top-right-radius:0;border-bottom-right-radius:0}.p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:last-of-type{border-top-left-radius:0;border-bottom-left-radius:0}.p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:focus{position:relative;z-index:1}'],changeDetection:0})),h})(),P=(()=>{var c;class h{}return c=h,(0,o.Z)(h,"\u0275fac",function(l){return new(l||c)}),(0,o.Z)(h,"\u0275mod",n.oAB({type:c})),(0,o.Z)(h,"\u0275inj",n.cJS({imports:[u.ez,v.T]})),h})()}}]);